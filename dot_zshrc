# Path configuration
path=("$HOME/.local/bin" $path)
path=("$HOME/.zvm/bin" $path)
path=("$HOME/go/bin" $path)
path=("$HOME/.local/share/solana/install/active_release/bin" $path)
export PATH

# Editor
export EDITOR=nvim

# NVM Setup
export NVM_DIR="$HOME/.nvm"
if [ -f /usr/share/nvm/init-nvm.sh ]; then
    # Arch Linux
    source /usr/share/nvm/init-nvm.sh
elif [ -f "$HOME/.nvm/nvm.sh" ]; then
    # MacOS/standard install
    source "$HOME/.nvm/nvm.sh"
elif [ -s "/opt/homebrew/opt/nvm/nvm.sh" ]; then
    # MacOS Homebrew (Apple Silicon)
    source "/opt/homebrew/opt/nvm/nvm.sh"
elif [ -s "/usr/local/opt/nvm/nvm.sh" ]; then
    # MacOS Homebrew (Intel)
    source "/usr/local/opt/nvm/nvm.sh"
fi

# Lean
[ -f "$HOME/.elan/env" ] && source "$HOME/.elan/env"

# pnpm
export PNPM_HOME="$HOME/.local/share/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
# pnpm end

# Interactive shell configuration
if [[ $- == *i* ]]; then
    # System update alias (Linux only)
    if [ -f "$HOME/.config/arch/update-system.sh" ]; then
        alias update="$HOME/.config/arch/update-system.sh"
    fi

    # GNOME Control Center (works outside GNOME)
    alias gnome-settings="env XDG_CURRENT_DESKTOP=GNOME gnome-control-center"

    # Command aliases
    alias cat='bat'
    alias ls='lsd'
    alias vim='nvim'
    alias grok='codex --model grok-code-fast-1 --config model_provider="xai"'
    alias grok-full='codex --model grok-4-latest --config model_provider="xai"'
    alias codex-local='codex --oss'
    alias codex-deepseek='codex --model deepseek/deepseek-v3.2 --config model_provider="openrouter"'

    # VPN aliases
    alias vpn-on='sudo systemctl start openvpn-client@rejewski'
    alias vpn-off='sudo systemctl stop openvpn-client@rejewski'
    alias vpn-status='systemctl is-active openvpn-client@rejewski && curl -s ifconfig.me'

    # Starship prompt
    eval "$(starship init zsh)"

    # direnv
    eval "$(direnv hook zsh)"

    # zoxide - smarter cd command
    eval "$(zoxide init zsh)"
    alias cd="z"

    # fzf - fuzzy finder key bindings
    # Ctrl+R: command history search
    # Ctrl+T: file search
    # Alt+C: directory search
    if [ -f /usr/share/fzf/key-bindings.zsh ]; then
        # Arch Linux
        source /usr/share/fzf/key-bindings.zsh
        source /usr/share/fzf/completion.zsh
    elif [ -f "$HOME/.fzf.zsh" ]; then
        # Standard install
        source "$HOME/.fzf.zsh"
    elif [ -f /opt/homebrew/opt/fzf/shell/key-bindings.zsh ]; then
        # MacOS Homebrew (Apple Silicon)
        source /opt/homebrew/opt/fzf/shell/key-bindings.zsh
        source /opt/homebrew/opt/fzf/shell/completion.zsh
    elif [ -f /usr/local/opt/fzf/shell/key-bindings.zsh ]; then
        # MacOS Homebrew (Intel)
        source /usr/local/opt/fzf/shell/key-bindings.zsh
        source /usr/local/opt/fzf/shell/completion.zsh
    fi

    # Enable completion system
    autoload -Uz compinit
    compinit

    # History configuration
    HISTSIZE=10000
    SAVEHIST=10000
    HISTFILE=~/.zsh_history
    setopt HIST_IGNORE_DUPS
    setopt HIST_FIND_NO_DUPS
    setopt SHARE_HISTORY

    # Case-insensitive completion
    zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'
fi

# zsh-syntax-highlighting
if [ -f /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]; then
    # Arch Linux
    source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
elif [ -f /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]; then
    # MacOS Homebrew (Apple Silicon)
    source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
elif [ -f /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]; then
    # MacOS Homebrew (Intel)
    source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

# opencode
if [ -d "$HOME/.opencode/bin" ]; then
    export PATH="$HOME/.opencode/bin:$PATH"
fi
